## 深度学习推荐系统

### 1. 推荐系统的发展

协同过滤（Collaborative Filtering）、逻辑回归（Logistic Regression）、因子分解机（Factorization Machine）：可解释性强、硬件环境要求低、易于快速训练和部署。

协同过滤算法：物品协同过滤（ItemCF）、用户协同过滤（UserCF）、矩阵分解模型（Matrix Factorization）。

逻辑回归模型：大规模分片线性模型（Large Scale Piece-wise Linear Model）。

因子分解机模型：域感知因子分解机（Field-aware Factorization Machine, FFM）。

组合模型：融合多个模型的优点，GBDT+LR[梯度提升决策树（Gradient Boosting Decision Tree）]

#### 1.1. 协同过滤

**基于用户的协同过滤（UserCF）**

考虑各种反馈和评价意见，把感兴趣的信息过滤出来，进行推荐排序。

排序的依据是相似度，分为用户相似度和物品相似度。

计算两个用户的相似度有几种方法：

1. 余弦相似度：就是计算两个向量的余弦
2. 皮尔逊相关系数：有两种方式，使用用户对所有物品的平均评分和物品平均分

缺点：（1）用户数的增长会导致，会导致数据量极具增大（以 $n^2$ 的速度）。（2）数据向量很稀疏，不适用于类似酒店预订、大件商品等低频购买的场景。

适用于：新闻推荐场景，满足新闻兴趣分散的特点，及时性、热点性，能够跟踪热点。

**基于物品的协同过滤（ItemCF）**

计算物品的相似度：
$$
R_{u,p}=\sum_{h\in H}(w_{p,h}\cdot R_{u,h})
$$
$H$ 是目标用户的正反馈物品集合，$w_{p,h}$ 是物品 $p$ 与物品 $h$ 的物品相似度，$R_{u,h}$ 是用户 $u$ 对物品 $h$ 的已有评分。

适用于：Amazon 的电商场景、Netflix 的视频推荐场景等兴趣在一个时间段内兴趣较为稳定的。

**协同过滤缺陷**：没有较强的泛化能力。热门产品由于多人购买，与其他产品会有较大的相似度，而冷门的产品却相反。

#### 1.2. 矩阵分解算法

矩阵分解在协同过滤算法中「共现矩阵」的基础上，加入了隐向量的概念，加强了处理稀疏矩阵的能力。

矩阵分解算法将用户和数据（视频）定位到隐向量表示的空间上，为用户推荐距离最近的数据。

**如何获得隐向量？**

矩阵分解有三种方法：特征值分解（Eigen Decomposition）[只适用于方阵]、奇异值分解（Singular Value Decomposition， SVD）、梯度下降（Gradient Descent）。